library("stratification")
install.packages("stratification")
strata_data <- read.csv("Input_data_structure.csv")
load("D:/simple-stratif/Strata_evaluation_v1/Strata_evauluation.R")
read.csv("Input_data_structure.csv")
setwd ("F:/R/Strata_evaluation")
setwd ("D:/simple-stratif/Strata_evaluation_v1")
strata_data <- read.csv("Input_data_structure.csv")
strata_detail <- read.csv("control_file.csv")
View(strata_data)
View(strata_detail)
#single inputs
cell_res <- 30 #resolution of grid cells in meters
strata_data <- read.csv("Input_data_structure.csv")
View(strata_data)
View(optim)
strata_data <- read.csv("Input_data_structure.csv")
strata_detail <- read.csv("control_file.csv")
cell_res <- 30 #resolution of grid cells in meters
strata_detail$p_st_a <- with(strata_detail, (p_cell_n) * (cell_res^2))
strata_detail$p_st_ra <- (p_st_a/sum(p_st_a))
View(strata_detail)
strata_detail$p_st_ra <- (p_st_a/sum(p_st_a))
strata_detail$p_st_ra <- with(strata_detail, (p_st_a)/(sum(p_st_a)))
View(p_st_ra)
View(strata_detail$p_st_ra)
View(strata_detail)
strata_detail$o_st_ra <- with(strata_detail, (o_st_a)/(sum(o_st_a)))
View(strata_detail)
strata_detail$o_st_a <- with(strata_detail, (o_cell_n) * (cell_res^2))
strata_detail$o_st_ra <- with(strata_detail, (o_st_a)/(sum(o_st_a)))
strata_detail$p_ah_nh <- with(strata_detail, (p_st_ra)/(p_count))
str(strata_detail)
strata_data$p_st <- as.factor(strata_data$p_st)
strata_data$o_st <- as.factor(paste("o", strata_data$o_st, sep="_"))
View(strata_detail)
strata_detail$o_st_ID <- as.factor(paste("o", strata_detail$o_st_ID, sep="_"))      #convert optimised strata to factor in strata_detail
View(strata_detail)
eq_8.9n <- NULL       #numerator of Zrd (mean of intersection), requires reference to cells in starta_detail based on prior area of intersecting strata & prior allocation
for(j in 1:length(levels(strata_data$o_st))){
x <- strata_data[strata_data$o_st==levels(strata_data$o_st)[j],c("p_st","pred_C","o_st")]
eq_8.9n[[levels(strata_data$o_st)[j]]] <- aggregate(x[,c("pred_C")], by=list(x$p_st), FUN=sum)
}
fix(eq_8.9n)
fix(eq_8.9n)
eq_8.9n <- do.call(rbind, eq_8.9n)
eq_8.9n$o_st <- sapply(strsplit(row.names(eq_8.9n), "\\."), function(x){x[1]})
View(eq_8.9n)
View(x)
View(strata_detail)
View(x)
View(eq_8.9n)
View(strata_detail)
eq_8.9n$p_ah_nh <- match(eq_8.9n$o_st,strata_detail$p_ah_nh)
View(eq_8.9n)
eq_8.9n$p_ah_nh <- match(eq_8.9n$o_st,strata_detail$o_st_ID)
View(eq_8.9n)
View(strata_data)
View(strata_detail)
eq_8.9n$p_ah_nh <- match(eq_8.9n$o_st,strata_detail$p_ah_nh) #only matches
View(eq_8.9n)
eq_8.9n$p_ah_n <- if(eq_8.9n$o_st==strata_detail$o_st_ID,strata_detail$p_ah_nh)
eq_8.9n$p_ah_n <- if(eq_8.9n$o_st==strata_detail$o_st_ID {group <- strata_detail$p_ah_nh})
eq_8.9n$p_ah_n <- if(eq_8.9n$o_st==strata_detail$o_st_ID) {group <- strata_detail$p_ah_nh}
fix(group)
eq_8.9n$p_ah_nh <- if(eq_8.9n$o_st==strata_detail$o_st_ID) {eq_8.9n$p_ah_nh <- strata_detail$p_ah_nh} #row conflicts..
View(eq_8.9n)
View(eq_8.9n)
View(strata_detail)
View(strata_detail)
eq_8.9n$p_ah_nh <- NULL
View(eq_8.9n)
eq_8.9n$p_ah_nh <- match(eq_8.9n$o_st,strata_detail$p_ah_nh) #designator missing... ?
View(eq_8.9n)
